<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…ÛŒÙ†ÛŒâ€ŒØ§Ù¾ Ú¯Ø±ÙˆÙ‡â€ŒÙ‡Ø§</title>
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js';
        import { getFirestore, collection, addDoc, getDocs } from 'https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js';
    </script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            direction: rtl;
            background-color: #f0f0f0;
            margin: 0;
            padding: 20px;
        }
        h1, h2 {
            color: #333;
        }
        .category {
            margin: 20px;
        }
        .category button {
            padding: 15px 30px;
            margin: 10px;
            font-size: 18px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            background-color: #4CAF50;
            color: white;
        }
        .category button:hover {
            background-color: #45a049;
        }
        #travel-form, #event-form, #shop-form, #ad-creator {
            display: none;
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        #travel-ads, #event-ads, #shop-ads {
            display: none;
            background-color: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            margin-top: 20px;
            text-align: right;
        }
        .form-group {
            margin: 10px 0;
        }
        .form-group label {
            display: block;
            font-size: 16px;
            margin-bottom: 5px;
        }
        .form-group input, .form-group textarea {
            width: 90%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 14px;
        }
        #submit-travel, #submit-event, #submit-shop {
            background-color: #008CBA;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        #submit-travel:hover, #submit-event:hover, #submit-shop:hover {
            background-color: #007399;
        }
        .ad-item {
            border-bottom: 1px solid #ccc;
            padding: 10px 0;
        }
        .ad-item:last-child {
            border-bottom: none;
        }
    </style>
</head>
<body>
    <h1>ğŸ§³ Ù…ÛŒÙ†ÛŒâ€ŒØ§Ù¾ Ú¯Ø±ÙˆÙ‡â€ŒÙ‡Ø§</h1>
    <div class="category">
        <button onclick="showSection('event')">ğŸ«‚ Ø§ÛŒÙˆÙ†Øªâ€ŒÙ‡Ø§</button>
        <button onclick="showSection('shop')">ğŸ›ï¸ ÙØ±ÙˆØ´Ú¯Ø§Ù‡</button>
        <button onclick="showSection('travel')">ğŸ•ï¸ Ú¯Ø±ÙˆÙ‡â€ŒÙ‡Ø§ÛŒ Ø³ÙØ±</button>
        <button onclick="showSection('ad-creator')">ğŸ“ Ø¢Ú¯Ù‡ÛŒâ€ŒØ³Ø§Ø²</button>
    </div>
    <form id="travel-form">
        <h2>ğŸ“ Ø«Ø¨Øª Ø¢Ú¯Ù‡ÛŒ Ø³ÙØ±</h2>
        <div class="form-group">
            <label>ğŸï¸ Ù…Ù‚ØµØ¯:</label>
            <input type="text" id="travel-destination" placeholder="Ù…Ø«Ù„Ø§Ù‹: Ø´ÛŒØ±Ø§Ø²">
        </div>
        <button type="button" id="submit-travel">âœ… Ø«Ø¨Øª Ø¢Ú¯Ù‡ÛŒ</button>
    </form>
    <form id="event-form">
        <h2>ğŸ“… Ø«Ø¨Øª Ø§ÛŒÙˆÙ†Øª</h2>
        <div class="form-group">
            <label>ğŸ‰ Ø¹Ù†ÙˆØ§Ù†:</label>
            <input type="text" id="event-title" placeholder="Ù…Ø«Ù„Ø§Ù‹: Ø¬Ø´Ù† ØªÙˆÙ„Ø¯">
        </div>
        <div class="form-group">
            <label>ğŸ“… ØªØ§Ø±ÛŒØ®:</label>
            <input type="text" id="event-date" placeholder="Ù…Ø«Ù„Ø§Ù‹: 1404/03/05">
        </div>
        <div class="form-group">
            <label>ğŸ“ Ù…Ú©Ø§Ù†:</label>
            <input type="text" id="event-location" placeholder="Ù…Ø«Ù„Ø§Ù‹: ØªÙ‡Ø±Ø§Ù†ØŒ Ù¾Ø§Ø±Ú© Ù…Ù„Øª">
        </div>
        <div class="form-group">
            <label>ğŸ§ Ø¸Ø±ÙÛŒØª:</label>
            <input type="text" id="event-capacity" placeholder="Ù…Ø«Ù„Ø§Ù‹: 50 Ù†ÙØ±">
        </div>
        <div class="form-group">
            <label>ğŸ’° Ù‡Ø²ÛŒÙ†Ù‡:</label>
            <input type="text" id="event-cost" placeholder="Ù…Ø«Ù„Ø§Ù‹: 500,000 ØªÙˆÙ…Ø§Ù†">
        </div>
        <button type="button" id="submit-event">âœ… Ø«Ø¨Øª Ø§ÛŒÙˆÙ†Øª</button>
    </form>
    <form id="shop-form">
        <h2>ğŸ›ï¸ Ø«Ø¨Øª Ù…Ø­ØµÙˆÙ„</h2>
        <div class="form-group">
            <label>ğŸ“¦ ÙˆØ¶Ø¹ÛŒØª Ù…Ø­ØµÙˆÙ„:</label>
            <input type="text" id="shop-status" placeholder="Ù…Ø«Ù„Ø§Ù‹: Ù†Ùˆ / Ú©Ø§Ø±Ú©Ø±Ø¯Ù‡ / Ø¯Ø± Ø­Ø¯ Ù†Ùˆ">
        </div>
        <div class="form-group">
            <label>ğŸ·ï¸ Ø¨Ø±Ù†Ø¯:</label>
            <input type="text" id="shop-brand" placeholder="Ù…Ø«Ù„Ø§Ù‹: Ø³Ø§Ù…Ø³ÙˆÙ†Ú¯">
        </div>
        <div class="form-group">
            <label>ğŸ“… Ø³Ø§Ù„ ØªÙˆÙ„ÛŒØ¯:</label>
            <input type="text" id="shop-year" placeholder="Ù…Ø«Ù„Ø§Ù‹: 1399">
        </div>
        <div class="form-group">
            <label>ğŸ’° Ù‚ÛŒÙ…Øª:</label>
            <input type="text" id="shop-price" placeholder="Ù…Ø«Ù„Ø§Ù‹: 2,000,000 ØªÙˆÙ…Ø§Ù†">
        </div>
        <div class="form-group">
            <label>ğŸ“ ØªÙˆØ¶ÛŒØ­Ø§Øª:</label>
            <textarea id="shop-description" placeholder="ØªÙˆØ¶ÛŒØ­Ø§Øª Ù…Ø­ØµÙˆÙ„..."></textarea>
        </div>
        <button type="button" id="submit-shop">âœ… Ø«Ø¨Øª Ù…Ø­ØµÙˆÙ„</button>
    </form>
    <div id="ad-creator">
        <h2>ğŸ“ Ø¢Ú¯Ù‡ÛŒâ€ŒØ³Ø§Ø²</h2>
        <p>Ø¨Ø±Ø§ÛŒ Ø³Ø§Ø®Øª Ø¢Ú¯Ù‡ÛŒØŒ Ø¨Ù‡ Ø±Ø¨Ø§Øª ØªÙ„Ú¯Ø±Ø§Ù… Ù…Ø§ Ø¨Ø±ÙˆÛŒØ¯ Ùˆ ÙØ±Ù… Ø±Ø§ Ù¾Ø± Ú©Ù†ÛŒØ¯:</p>
        <a href="https://t.me/DooostiHa_bot" target="_blank">Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ø±Ø¨Ø§Øª (@DooostiHa_bot)</a>
    </div>
    <div id="travel-ads">
        <h2>ğŸ•ï¸ Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§ÛŒ Ú¯Ø±ÙˆÙ‡â€ŒÙ‡Ø§ÛŒ Ø³ÙØ±</h2>
        <div id="travel-ads-list"></div>
    </div>
    <div id="event-ads">
        <h2>ğŸ«‚ Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§ÛŒ Ø§ÛŒÙˆÙ†Øªâ€ŒÙ‡Ø§</h2>
        <div id="event-ads-list"></div>
    </div>
    <div id="shop-ads">
        <h2>ğŸ›ï¸ Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§ÛŒ ÙØ±ÙˆØ´Ú¯Ø§Ù‡</h2>
        <div id="shop-ads-list"></div>
    </div>
    <script type="module">
        let db;
        let isFirebaseReady = false;

        // Initialize Firebase
        const firebaseConfig = {
		  apiKey: "AIzaSyCfMjevdSohHrq6dJxdlrmJ0MZT5HZKZAw",
		  authDomain: "doostihagroupapp.firebaseapp.com",
		  projectId: "doostihagroupapp",
		  storageBucket: "doostihagroupapp.firebasestorage.app",
		  messagingSenderId: "746714229972",
		  appId: "1:746714229972:web:72a26758b58e2ede009f41"
        };

        const app = initializeApp(firebaseConfig);
        db = getFirestore(app);
        isFirebaseReady = true;

        // ØªÙ†Ø¸ÛŒÙ…Ø§Øª Telegram Web App
        const tg = window.Telegram.WebApp;
        tg.ready();
        tg.MainButton.setText("Ø¨Ø³ØªÙ†").show().onClick(() => tg.close());

        // Ù†Ù…Ø§ÛŒØ´ Ø¨Ø®Ø´â€ŒÙ‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù
        function showSection(section) {
            document.getElementById('travel-form').style.display = 'none';
            document.getElementById('event-form').style.display = 'none';
            document.getElementById('shop-form').style.display = 'none';
            document.getElementById('ad-creator').style.display = 'none';
            document.getElementById('travel-ads').style.display = 'none';
            document.getElementById('event-ads').style.display = 'none';
            document.getElementById('shop-ads').style.display = 'none';

            if (section === 'travel') {
                document.getElementById('travel-form').style.display = 'block';
                loadTravelAds();
            } else if (section === 'event') {
                document.getElementById('event-form').style.display = 'block';
                loadEventAds();
            } else if (section === 'shop') {
                document.getElementById('shop-form').style.display = 'block';
                loadShopAds();
            } else if (section === 'ad-creator') {
                document.getElementById('ad-creator').style.display = 'block';
            }
        }

        // Ø«Ø¨Øª Ø¢Ú¯Ù‡ÛŒ Ø³ÙØ±
        document.getElementById('submit-travel').addEventListener('click', () => {
            const travelData = {
                destination: document.getElementById('travel-destination').value,
                timestamp: new Date().toISOString()
            };

            if (!isFirebaseReady) {
                alert('Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ø³Ø±ÙˆØ± Ù‚Ø·Ø¹ Ø§Ø³Øª! Ù„Ø·ÙØ§Ù‹ Ø¨Ø¹Ø¯Ø§Ù‹ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ø§Ù…ØªØ­Ø§Ù† Ú©Ù†ÛŒØ¯.');
                return;
            }

            addDoc(collection(db, 'travels'), travelData)
                .then(() => {
                    alert('Ø¢Ú¯Ù‡ÛŒ Ø³ÙØ± Ø«Ø¨Øª Ø´Ø¯!');
                    document.getElementById('travel-form').reset();
                    loadTravelAds();
                })
                .catch(error => {
                    alert('Ø®Ø·Ø§: ' + error.message);
                    console.error('Error saving travel data:', error);
                });
        });

        // Ø«Ø¨Øª Ø§ÛŒÙˆÙ†Øª
        document.getElementById('submit-event').addEventListener('click', () => {
            const eventData = {
                title: document.getElementById('event-title').value,
                date: document.getElementById('event-date').value,
                location: document.getElementById('event-location').value,
                capacity: document.getElementById('event-capacity').value,
                cost: document.getElementById('event-cost').value,
                timestamp: new Date().toISOString()
            };

            if (!isFirebaseReady) {
                alert('Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ø³Ø±ÙˆØ± Ù‚Ø·Ø¹ Ø§Ø³Øª! Ù„Ø·ÙØ§Ù‹ Ø¨Ø¹Ø¯Ø§Ù‹ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ø§Ù…ØªØ­Ø§Ù† Ú©Ù†ÛŒØ¯.');
                return;
            }

            addDoc(collection(db, 'events'), eventData)
                .then(() => {
                    alert('Ø§ÛŒÙˆÙ†Øª Ø«Ø¨Øª Ø´Ø¯!');
                    document.getElementById('event-form').reset();
                    loadEventAds();
                })
                .catch(error => {
                    alert('Ø®Ø·Ø§: ' + error.message);
                    console.error('Error saving event data:', error);
                });
        });

        // Ø«Ø¨Øª Ù…Ø­ØµÙˆÙ„
        document.getElementById('submit-shop').addEventListener('click', () => {
            const shopData = {
                status: document.getElementById('shop-status').value,
                brand: document.getElementById('shop-brand').value,
                year: document.getElementById('shop-year').value,
                price: document.getElementById('shop-price').value,
                description: document.getElementById('shop-description').value,
                timestamp: new Date().toISOString()
            };

            if (!isFirebaseReady) {
                alert('Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ø³Ø±ÙˆØ± Ù‚Ø·Ø¹ Ø§Ø³Øª! Ù„Ø·ÙØ§Ù‹ Ø¨Ø¹Ø¯Ø§Ù‹ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ø§Ù…ØªØ­Ø§Ù† Ú©Ù†ÛŒØ¯.');
                return;
            }

            addDoc(collection(db, 'shop'), shopData)
                .then(() => {
                    alert('Ù…Ø­ØµÙˆÙ„ Ø«Ø¨Øª Ø´Ø¯!');
                    document.getElementById('shop-form').reset();
                    loadShopAds();
                })
                .catch(error => {
                    alert('Ø®Ø·Ø§: ' + error.message);
                    console.error('Error saving shop data:', error);
                });
        });

        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§ÛŒ Ø³ÙØ±
        async function loadTravelAds() {
            const travelAdsList = document.getElementById('travel-ads-list');
            travelAdsList.innerHTML = '';
            try {
                const travelsSnapshot = await getDocs(collection(db, 'travels'));
                if (travelsSnapshot.empty) {
                    travelAdsList.innerHTML = '<p>Ø¢Ú¯Ù‡ÛŒ Ø³ÙØ±ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯.</p>';
                } else {
                    travelsSnapshot.forEach(doc => {
                        const data = doc.data();
                        const adDiv = document.createElement('div');
                        adDiv.className = 'ad-item';
                        adDiv.innerHTML = `
                            Ù…Ù‚ØµØ¯: ${data.destination || 'Ù†Ø§Ù…Ø´Ø®Øµ'}<br>
                            ØªØ§Ø±ÛŒØ® Ø«Ø¨Øª: ${new Date(data.timestamp).toLocaleString('fa-IR')}
                        `;
                        travelAdsList.appendChild(adDiv);
                    });
                }
            } catch (error) {
                travelAdsList.innerHTML = '<p>Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§: ' + error.message + '</p>';
            }
        }

        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§ÛŒ Ø§ÛŒÙˆÙ†Øª
        async function loadEventAds() {
            const eventAdsList = document.getElementById('event-ads-list');
            eventAdsList.innerHTML = '';
            try {
                const eventsSnapshot = await getDocs(collection(db, 'events'));
                if (eventsSnapshot.empty) {
                    eventAdsList.innerHTML = '<p>Ø¢Ú¯Ù‡ÛŒ Ø§ÛŒÙˆÙ†ØªÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯.</p>';
                } else {
                    eventsSnapshot.forEach(doc => {
                        const data = doc.data();
                        const adDiv = document.createElement('div');
                        adDiv.className = 'ad-item';
                        adDiv.innerHTML = `
                            Ø¹Ù†ÙˆØ§Ù†: ${data.title || 'Ù†Ø§Ù…Ø´Ø®Øµ'}<br>
                            ØªØ§Ø±ÛŒØ®: ${data.date || 'Ù†Ø§Ù…Ø´Ø®Øµ'}<br>
                            Ù…Ú©Ø§Ù†: ${data.location || 'Ù†Ø§Ù…Ø´Ø®Øµ'}<br>
                            ØªØ§Ø±ÛŒØ® Ø«Ø¨Øª: ${new Date(data.timestamp).toLocaleString('fa-IR')}
                        `;
                        eventAdsList.appendChild(adDiv);
                    });
                }
            } catch (error) {
                eventAdsList.innerHTML = '<p>Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§: ' + error.message + '</p>';
            }
        }

        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§ÛŒ ÙØ±ÙˆØ´Ú¯Ø§Ù‡
        async function loadShopAds() {
            const shopAdsList = document.getElementById('shop-ads-list');
            shopAdsList.innerHTML = '';
            try {
                const shopSnapshot = await getDocs(collection(db, 'shop'));
                if (shopSnapshot.empty) {
                    shopAdsList.innerHTML = '<p>Ø¢Ú¯Ù‡ÛŒ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯.</p>';
                } else {
                    shopSnapshot.forEach(doc => {
                        const data = doc.data();
                        const adDiv = document.createElement('div');
                        adDiv.className = 'ad-item';
                        adDiv.innerHTML = `
                            Ø¨Ø±Ù†Ø¯: ${data.brand || 'Ù†Ø§Ù…Ø´Ø®Øµ'}<br>
                            ÙˆØ¶Ø¹ÛŒØª: ${data.status || 'Ù†Ø§Ù…Ø´Ø®Øµ'}<br>
                            Ù‚ÛŒÙ…Øª: ${data.price || 'Ù†Ø§Ù…Ø´Ø®Øµ'}<br>
                            ØªØ§Ø±ÛŒØ® Ø«Ø¨Øª: ${new Date(data.timestamp).toLocaleString('fa-IR')}
                        `;
                        shopAdsList.appendChild(adDiv);
                    });
                }
            } catch (error) {
                shopAdsList.innerHTML = '<p>Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§: ' + error.message + '</p>';
            }
        }
    </script>
</body>
</html>
